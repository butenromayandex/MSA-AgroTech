# ADR. Выбор финального решения

### **Критерии сравнения**

Для выбора архитектуры были определены следующие критерии (в порядке убывания важности):
1.  **Автономность (Offline Mode)**: Способность системы выполнять критические функции (видеоаналитика, управление кормушками) без связи с интернетом.
2.  **Latency (Задержка)**: Гарантия реакции на инцидент менее чем за 5 секунд.
3.  **Стоимость эксплуатации (OpEx)**: Затраты на трафик и облачные ресурсы.
4.  **Сложность поддержки (Maintainability)**: Удобство обновления и диагностики ПО.

### **Анализ вариантов**

**Вариант 1: Гибридная архитектура (Edge + Cloud)**
*   **Автономность**: 5/5 (Полная. Edge-сервер обрабатывает все локально).
*   **Latency**: 5/5 (Минимальная. Обработка на месте, нет сетевых задержек до облака).
*   **Стоимость эксплуатации**: 4/5 (Экономия на трафике, так как в облако идут только метаданные. Но нужны затраты на "железо").
*   **Сложность поддержки**: 2/5 (Сложно. Нужно администрировать удаленные сервера, настраивать CI/CD для Edge).

**Вариант 2: Облачная архитектура (Cloud Native)**
*   **Автономность**: 1/5 (Критически низкая. При обрыве связи ферма неуправляема).
*   **Latency**: 2/5 (Риск не уложиться в 5 секунд из-за нестабильного канала).
*   **Стоимость эксплуатации**: 2/5 (Высокая. Передача видеопотоков 24/7 потребляет огромный трафик).
*   **Сложность поддержки**: 5/5 (Просто. Все в одном месте, стандартные облачные практики).

### **Резюме и Рекомендация**

Несмотря на высокую сложность поддержки распределенной инфраструктуры, **рекомендуется выбрать Гибридную архитектуру (Вариант 1)**.

**Причины:**
1.  Бизнес-требование "работать даже в случае отсутствия интернета" является блокирующим для облачного решения.
2.  Требование по задержке (< 5 сек) на нестабильных каналах связи (3G/4G в полях) технически нереализуемо в Cloud-only архитектуре.

Мы готовы принять риск сложности администрирования Edge-устройств ради выполнения функциональных требований бизнеса.
